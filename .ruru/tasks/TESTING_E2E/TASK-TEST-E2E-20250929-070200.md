+++
id = "TASK-TEST-E2E-20250929-070200"
title = "Implement Comprehensive E2E Testing with Jest and Playwright"
status = "ðŸŸ¡ To Do"
type = "ðŸ§ª E2E Testing"
assigned_to = "test-e2e"
coordinator = "roo-commander"
created_date = "2025-09-29T07:02:00Z"
updated_date = "2025-09-29T07:02:00Z"
related_docs = [
  "package.json",
  "next.config.js"
]
tags = ["testing", "e2e", "jest", "playwright", "automation"]
+++

# Description

Implement comprehensive end-to-end (E2E) testing for the Next.js website using Jest as the testing framework, integrated with Playwright to automate browser interactions. Verify key functionalities including navigation, link validity, form submissions, and user flows across all pages (e.g., campaigns, prep, maps, library). Ensure tests simulate real user scenarios, handle dynamic content (e.g., AI-generated passages, modals), and include assertions for expected outcomes like successful page loads, correct redirects, error handling, and component rendering.

To maintain test independence, integrate manually created structured datasets (to be prepared separately) for test categories such as user interactions, form inputs, and edge cases. Store datasets in JSON/CSV files in a new `/test-data` directory.

Focus on the following areas based on project structure:
- Homepage interactions (e.g., toolkit blocks, interactive content).
- Campaign management (create, load, save, delete campaigns; character handling).
- Session prep (notes editing, saving, printing, markdown export).
- Maps generation and display.
- Library and generated content flows.
- Authentication flows (if applicable, simulate Firebase integration).
- Error states (e.g., no active campaign, failed saves).

# Acceptance Criteria
- [ ] Jest and Playwright are installed and configured in package.json and test setup files.
- [ ] At least 80% test coverage for critical user flows (navigation, forms, modals).
- [ ] Tests run successfully in headless mode and produce screenshots/videos on failure.
- [ ] Tests are independent, using fixtures and datasets without relying on external AI services or live data.
- [ ] Integration with CI/CD (e.g., via GitHub Actions) for automated runs on PRs.
- [ ] Documentation added to README.md or a new /testing.md file with setup/run instructions.
- [ ] No breaking changes to existing code; tests pass on current features.

# Checklist
- [ ] Review project structure (Next.js app router, components like interactive-content.tsx, campaigns/page.tsx, prep/[id]/page.tsx, maps/page.tsx) to identify test targets.
- [ ] Install dependencies: jest, @playwright/test, playwright, jest-environment-jsdom (devDependencies).
- [ ] Configure Playwright: Run `npx playwright install` and set up playwright.config.ts.
- [ ] Set up Jest: Create jest.config.js, update package.json scripts (e.g., "test:e2e": "playwright test").
- [ ] Create /test-data directory with JSON/CSV datasets (e.g., test-users.json for campaigns, form-inputs.csv for edge cases; coordinate with dataset creation if separate).
- [ ] Write E2E tests:
  - [ ] Navigation tests (homepage to campaigns, prep, maps; link clicks).
  - [ ] Form submission tests (new campaign creation, session prep notes save/export).
  - [ ] User flow tests (load campaign, generate content, handle modals/toasts).
  - [ ] Dynamic content tests (AI flows simulation with mocks, interactive buttons).
  - [ ] Error handling tests (invalid inputs, no active campaign, network failures).
- [ ] Run tests: Ensure all pass, generate coverage report (aim >80% for tested paths).
- [ ] Add CI integration: Update .github/workflows for test runs on push/PR.
- [ ] Document setup: Add testing guidelines to docs/ or README.md.

# Notes
- Use Playwright over Puppeteer for better Next.js support and cross-browser testing.
- Mock Firebase and AI endpoints (e.g., genkit flows) to avoid external dependencies.
- Ensure tests are resilient to UI changes (use data-testid where possible).
- After completion, notify coordinator for verification and Codacy integration.